---
alwaysApply: true
---
---
Source: .ruler/instructions.md
---
# Memo MCP Server 使用说明

## 概述
本项目是一个基于 **Workerman** 和 **pfinalclub/php-mcp** 扩展包实现的 **MCP Server**，它提供了一个简易的备忘录（Memo）服务。  
可以通过 MCP 协议调用 `memo.list`、`memo.search` 等工具来查询备忘录。

## 功能列表

1. `memo.list`
   - **描述**: 获取所有备忘录
   - **参数**: 无
   - **返回值**: 包含成功状态、备忘录数组和总数的数组

2. `memo.search`
   - **描述**: 搜索备忘录
   - **参数**: `keyword` (string) - 搜索关键词
   - **返回值**: 包含成功状态、匹配的备忘录数组、结果数量和关键词的数组

## 运行方式
1. 安装依赖
   ```bash
   composer install
  ```
2. 启动 MCP Server

```bash
    php server.php
```
3. MCP Client 可以通过 stdio + JSON-RPC 协议与之交互。

## 使用示例

### 获取所有备忘录
```json
{
  "method": "tools/call",
  "params": {
    "name": "memo.list",
    "arguments": {}
  }
}
```

### 搜索备忘录
```json
{
  "method": "tools/call",
  "params": {
    "name": "memo.search",
    "arguments": {
      "keyword": "测试"
    }
  }
}
```

## 技术实现

### 工具定义
使用 PHP 8.2+ 的属性注解来定义 MCP 工具：

```php
#[McpTool(
    name: 'memo.list',
    description: '获取所有备忘录'
)]
public function listMemos(): array
{
    // 实现逻辑
}
```

### 参数定义
使用 Schema 属性定义参数：

```php
public function searchMemos(
    #[Schema(description: '搜索关键词')]
    string $keyword
): array
```

## 目录结构

```
project-root/
├── .ruler/
│   ├── ruler.toml
│   └── instructions.md
├── src/
│   ├── MemoServer.php
│   └── Models/
│       └── Memo.php
├── server.php
├── composer.json
└── vendor/

```

### 开发指南
- 使用 pfinalclub/php-mcp 包提供的 Server 类
- 通过属性注解定义 MCP 工具
- 使用 Workerman 实现 MCP 主循环
- 数据暂存可选用内存数组，或后续扩展到 SQLite/MySQL
- 支持查询操作（读取、搜索）
